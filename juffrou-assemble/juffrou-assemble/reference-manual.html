<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Juffrou Reference Documentation</title><link rel="stylesheet" type="text/css" href="./css/apache-maven-fluido-1.3.0.min.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><script xmlns:fo="http://www.w3.org/1999/XSL/Format" type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-36088259-2', 'sourceforge.net');
ga('send', 'pageview');
</script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="d0e1"></a>Juffrou Reference Documentation</h1></div><div><h2 class="subtitle">2.1.8-SNAPSHOT
	</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Carlos</span> <span class="surname">Martins</span></h3></div></div><div><p class="releaseinfo">
			This document refers to version 2.1.8-SNAPSHOT
			of the Juffrou group of libraries.
		</p></div><div><p class="copyright">Copyright &copy; 2013 Juffrou</p></div><div><div class="legalnotice"><a name="d0e18"></a><p>Copies of this document may be made for your own use and for
				distribution to others, provided
				that you do not charge any fee for such copies and further provided that
				each copy contains this
				Copyright Notice, whether distributed in print or electronically.
			</p></div></div></div><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d0e35"></a>Chapter&nbsp;1.&nbsp;Introduction</h1></div></div></div><p>Juffrou stands for Java Utilities Framework For the Rest Of Us and is a collection of useful classes or mini frameworks to help the java developer.</p><p>
			</p><div class="mediaobject"><img src="images/GraphToXml2.PNG"></div><p>
		</p><p>Do we need another XML marshalling / unmarshalling framework when there are already so many?</p><p>Well, it's true that there are many XML marshalling frameworks. I have used extensively XStream and Castor and I have huge admiration for those two frameworks. I am also a huge fan of cowtowncoder and his amazing jackson and fasterXml projects.</p><p>But as I got to know those frameworks I saw the good and the not so good in them and was always left with a feeling that there is something lacking.</p><p>I wanted something focused on marshalling java beans. Easy to configure with a choice for mapping file configuration or configuration through code. I wanted it to be easy to use, flexible - easy to extend and something that would handle the marshalling of nested beans into flat XML and back without pain.</p><p>Juffrou-XML is a first in that. So yes - we need this XML marshalling / unmarshalling framework.</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="reflect_ref_chpt_01"></a>Chapter&nbsp;2.&nbsp;Getting Started with Juffrou-reflect</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e60"></a>Introduction</h2></div></div></div><p>Juffrou-reflect is focused on reflection, and offers a very performant bean wrapper allowing bean introspection and manipulation through property names.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e65"></a>Installing</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e68"></a>Maven projects</h3></div></div></div><p>To start using Juffrou-XML in your maven project just add the following dependency:
</p><pre class="programlisting">
	<strong class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>net.sf.juffrou<strong class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>juffrou-reflect<strong class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;version&gt;</strong>2.1.8-SNAPSHOT<strong class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong>

</pre><p>
This will allow you access the source code of the library as well as the javadoc files, if you have checked the options "download artifact sources" and "download atifact javadoc in your IDE."
				</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e76"></a>Non maven projects</h3></div></div></div><p>Download the file <code class="filename">juffrou-2.1.8-SNAPSHOT-bundle.zip</code> from the <a class="ulink" href="http://cemartins.github.io/juffrou/index.html" target="_top"><em class="citetitle">website</em></a> and extract it's contents to a temporary directory.</p><p>Add <code class="filename">juffrou-reflect-2.1.8-SNAPSHOT.jar</code> to the classpath of your project and you are good to go.</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="reflect_ref_chpt_02"></a>Chapter&nbsp;3.&nbsp;Using Juffrou-reflect</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e96"></a>JuffrouBeanWrapper</h2></div></div></div><p>JuffrouBeanWrapper is the object that wraps around your beans and allows you to inspect them through the names of their properties. You can access the wrapped bean's properties and also the properties of beans referenced by them.</p><div class="figure"><a name="ClassDiagram"></a><p class="title"><b>Figure&nbsp;3.1.&nbsp;Example class diagram</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/ClassDiagram.PNG" alt="Example class diagram"></div></div></div><br class="figure-break"><p><a class="xref" href="#ClassDiagram" title="Figure&nbsp;3.1.&nbsp;Example class diagram">Figure&nbsp;3.1, &#8220;Example class diagram&#8221;</a> shows one class Person with three simple attributes and one attribute of type Address. The Address class is also shown and has two simple attributes.</p><p class="remark"><em><span class="remark">Person and Address will be used extensively throughout this manual in code examples.</span></em></p>
			A tipical use of JuffrouBeanWrapper could be:
			<pre class="programlisting">
			JuffrouBeanWrapper bw = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouBeanWrapper(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>); <a class="co" name="inst_co" href="#inst"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a>
			bw.setValue(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"firstName"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Carlos"</span>); <a class="co" name="firstname_co" href="#firstname"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a>
			bw.setValue(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"home.city"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Lisboa"</span>); <a class="co" name="city_co" href="#city"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a>
			Person person = (Person) bw.getBean(); <a class="co" name="getBean_co" href="#getBean"><span><img src="images/callouts/4.png" alt="4" border="0"></span></a>
			</pre><p class="remark"><em><span class="remark">Note: you can create a JuffrouBeanWrapper around a class or around an object instance.</span></em></p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="inst"></a><a href="#inst_co"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> </p></td><td valign="top" align="left"><p>Instantiate JuffrouBeanWrapper around a Person class</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="firstname"></a><a href="#firstname_co"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> </p></td><td valign="top" align="left"><p>Set the firstName property of Person with the value "Carlos".</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="city"></a><a href="#city_co"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a> </p></td><td valign="top" align="left"><p>Set the home property of Person with a new instance of an Address class and set the city property of Address to the value "Lisboa".</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="getBean"></a><a href="#getBean_co"><span><img src="images/callouts/4.png" alt="4" border="0"></span></a> </p></td><td valign="top" align="left"><p>Get the instance of the wrapped object.</p></td></tr></table></div><p>When the program executes <code class="literal">bw.setValue("firstName", "Carlos");</code> the bean wrapper creates an instance of Person. And when it
  executes <code class="computeroutput">bw.setValue("home.city", "Lisboa");</code> it will instantiate an Address class, set the value of the property <strong class="userinput"><code>city</code></strong> in Address to "Lisboa" and set the value of the property <strong class="userinput"><code>home</code></strong> in Person to the created Address instance.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e152"></a>Setting Bean Property Values</h3></div></div></div><p>When you execute the method <code class="literal">bw.setValue("birthDay", someObject)</code> to set the value of the birthDay property, the JuffrouBeanWrapper expects <code class="literal">someObject</code> to be of the same type as the bean property (in this case Date). And if it is not, it will throw an IllegalArgumentException exception.</p><p>But if you use the method <code class="literal">setValueOfString("birthDay", "1967-10-01")</code>, then the JuffrouBeanWrapper will try to convert the string value into the type of the property before setting it.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e168"></a>Collection properties</h3></div></div></div><p>The methods <code class="literal">addElement(String propertyName, Object element)</code> and <code class="literal">removeElement(String propertyName, Object element)</code> allow you to add and remove elements from a bean property of type collection.</p><p>These methods will add/remove the element directly from the collection property or call a method in the underlying bean to do the job.</p><div class="figure"><a name="BeanWithCollection"></a><p class="title"><b>Figure&nbsp;3.2.&nbsp;Example bean with a collection property</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/BeanWithCollection.png" alt="Example bean with a collection property"></div></div></div><br class="figure-break"><p>If you have a bean with a property like <code class="literal">List&lt;Address&gt; addresses</code> and that bean contains the methods
  <code class="literal">addAddress(Address address)</code> and <code class="literal">removeAddress(Address address)</code>, then these methods will be used to add remove elements from the collection.
  If not, then the normall collection methods will be used. In this case, the method <code class="literal">addElement(propertyName, element)</code> will be the equivalent of 
  <code class="literal">((Collection)getValue(propertyName)).add(element).</code></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e203"></a>Nested BeanWrappers</h3></div></div></div><p>When you access a nested property (i.e. a property of a nested bean), like in the case of <code class="computeroutput">bw.setValue("home.city", "Lisboa")</code>, the JuffrouBeanWrapper automatically creates another JuffrouBeanWrapper around the nested bean. In this case around an Address bean. This is called a nested bean wrapper.</p><p>Nested JuffrouBeanWrappers are created only when referenced by <code class="computeroutput">beanWrapper.getValue</code>, <code class="computeroutput">beanWrapper.setValue</code>, <code class="computeroutput">beanWrapper.getType</code>, <code class="computeroutput">beanWrapper.getClass</code> or <code class="computeroutput">beanWrapper.getNestedWrapper</code>.</p><p>You can get a specific nested bean wrapper with the method <code class="computeroutput">beanWrapper.getNestedWrapper("home")</code> and you can get all current nested bean wrappers with the method <code class="computeroutput">beanWrapper.getNestedWrappers()</code>.</p><p>If you want to change the wrapped instance without creating a new JuffrouBeanWrapper you can call <code class="literal">bw.setBean(newInstance)</code> and if you want to zero all properties of the wrapped instance you can call <code class="literal">bw.setBean(null)</code>.</p></div><p>In case you don't know the details of the Wrapped object, you can inquire the JuffrouBeanWrapper:</p><div class="example"><a name="d0e248"></a><p class="title"><b>Example&nbsp;3.1.&nbsp;Inquiring the JuffrouBeanWrapper:</b></p><div class="example-contents"><pre class="programlisting">
		BeanWrapperContext context = BeanWrapperContext.create(Programmer.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>);
		JuffrouBeanWrapper beanWrapper = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouBeanWrapper(context);
		<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">for</strong>(String propertyName : beanWrapper.getPropertyNames()) {
			Type type = beanWrapper.getType(propertyName);
			Object value = beanWrapper.getValue(propertyName);
			System.out.println(type + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">": "</span> + value);
		}
	</pre></div></div><br class="example-break"><p>Sometimes you want to have control over bean instantiation and would like to set some "preferences" over how JuffrouBeanWrapper behaves. This is where the BeanWrapperContext comes in.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e257"></a>BeanWrapperContext</h3></div></div></div><p>The BeanWrapperContext is the object that holds metadata for a BeanWrapper. This metadata is composed by data collected through class introspection, including the references to the getter and setter methods of the class and all classes it extends.</p><p>If you instantiate a BeanWrapper using the default constructor, it will create a new BeanWrapperContext. But if you instantiate a BeanWrapper by passing a BeanWrapperContext, no introspection overhead is needed.</p><div class="table"><a name="d0e264"></a><p class="title"><b>Table&nbsp;3.1.&nbsp;time in milliseconds to handle 10.000 BeanWrappers</b></p><div class="table-contents"><table summary="time in milliseconds to handle 10.000 BeanWrappers" border="1"><colgroup><col><col><col></colgroup><thead><tr><th align="left">Mode</th><th align="left">Instantiation only</th><th align="left">With property setting</th></tr></thead><tbody><tr><td align="left">Spring Framework's BeanWrapperImpl</td><td align="left">64</td><td align="left">291</td></tr><tr><td align="left">JuffrouBeanWrapper</td><td align="left">9</td><td align="left">41</td></tr><tr><td align="left">JuffrouBeanWrapper with BeanWrapperContext</td><td align="left">1</td><td align="left">20</td></tr><tr><td align="left">JuffrouBeanWrapper with BeanWrapperFactory</td><td align="left">9</td><td align="left">20</td></tr></tbody></table></div></div><br class="table-break"><p class="remark"><em><span class="remark">JDK 6 build 35 running on a Windows 7 32bit (Intel i3 2,93GHz with 4GB ram) machine</span></em></p><p>When a JuffrouBeanWrapper creates a nested JuffrouBeanWrapper it also creates a nested BeanWrapperContext, of course. But it will only create one BeanWrapperContext per property type, so, for instance, if you have a BeanWrapper around a class Person with two properties (home and work) of type Address, you can have two nested JuffrouBeanWrappers (one for home and another for work), but only one nested BeanWrapperContext.</p><p>You can obtain the BeanWrapperContext of a JuffrouBeanWrapper at any time calling the method <code class="literal">beanWrapper.getContext()</code>.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e314"></a>Controling bean instantiation</h4></div></div></div><p>With BeanWrapperContext you can define a class that will be called to instantiate the wrapped class as well as the classes of the nested beans whenever they need to be instantiated. To do this, first create a class that implements the interface <code class="computeroutput">BeanInstanceBuilder</code>. See the following example:</p><pre class="programlisting">
		BeanInstanceBuilder iCreator = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> BeanInstanceBuilder() {
			<em><span class="hl-annotation" style="color: gray">@Override</span></em>
			<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> Object build(Class clazz) <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">throws</strong> BeanInstanceBuilderException {
				Programmer programmer = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> Programmer();
				programmer.setLastName(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Smith"</span>);
				<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">return</strong> programmer;
			}
		};
		BeanWrapperContext context = BeanWrapperContext.create(Programmer.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>);
		context.setBeanInstanceBuilder(iCreator);
		JuffrouBeanWrapper bw = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouBeanWrapper(context);
		bw.setValue(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"firstName"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"John"</span>);
		Programmer programmer = (Programmer) bw.getBean();
		Assert.assertEquals(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"John"</span>, programmer.getFirstName());
		Assert.assertEquals(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Smith"</span>, programmer.getLastName());
			</pre><p>You might also want to associate more information with a bean than the introspection information collected by the BeanWrapperContext.
			For instance you might want add information to help represent the bean in XML format (like Juffrou-XML does). This is where the CustomizableBeanWrapperFactory comes in.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e326"></a>CustomizableBeanWrapperFactory</h4></div></div></div><p>The BeanWrapperFactory is the object responsible for creating all the BeanWrapperContexts. It does mainly three things:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" style="list-style-type: disc">Keeps track of the BeanWrapperContexts it creates, so it doesn't create two BeanWrapperContexts for the same bean class.</li><li class="listitem" style="list-style-type: disc">Injects itself into the BeanWrapperContexts it creates, so that they can use the same factory to create their nested BeanWrapperContexts.</li><li class="listitem" style="list-style-type: disc">Gives out BeanWrapperContexts upon call to <code class="literal">factory.getBeanWrapperContext(Person.class)</code> method. The BeanWrapperContext will only be created in none exists for the specified class (in this case Person.class).</li></ul></div><p>In fact you can also use the BeanWrapperFactory to instantiate JuffrouBeanWrappers using the methods <code class="literal">factory.getBeanWrapper(Person.class)</code> or <code class="literal">factory.getBeanWrapper(personIntance)</code> for example. This is as fast as instantiating a JuffrouBeanWrapper with a BeanWrapperContext parameter.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e349"></a>Extending the BeanWrapperContext</h4></div></div></div><p>So if you want to extend the BeanWrapperContext and add to the bean metadata all you have to do is create a class that extends BeanWrapperContext and "tell" the CustomizableBeanWrapperFactory to instantiate your class instead of BeanWrapperContext.</p><div class="example"><a name="d0e354"></a><p class="title"><b>Example&nbsp;3.2.&nbsp;Class that extends BeanWrapperContext</b></p><div class="example-contents"><pre class="programlisting">
<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong> MyBeanWrapperContext <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">extends</strong> BeanWrapperContext {

	<em class="hl-comment" style="color: silver">//TODO create properties to extend the context</em>
	
	<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> MyBeanWrapperContext(CustomizableBeanWrapperFactory factory, Class clazz, Type... types) {
		<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">super</strong>(factory, clazz, types);
		<em class="hl-comment" style="color: silver">//TODO some initialization</em>
	}
}
			</pre></div></div><br class="example-break"><p>And how do we "tell" the CustomizableBeanWrapperFactory to use this as BeanWrapperContext? Easy. We create a class that implements <span class="emphasis"><em>BeanContextBuilder</em></span> like this one:</p><pre class="programlisting">
<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong> MyContextBuilder <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">implements</strong> BeanContextBuilder {

	<em><span class="hl-annotation" style="color: gray">@Override</span></em>
	<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> MyBeanWrapperContext build(
						CustomizableBeanWrapperFactory factory,	Class clazz, Type... types) {

		MyBeanWrapperContext context = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> MyBeanWrapperContext(factory, clazz, types);
		<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">return</strong> context;
	}
}
			</pre><p>And then we "tell" CustomizableBeanWrapperFactory to use this builder. See the example bellow:</p><div class="example"><a name="d0e368"></a><p class="title"><b>Example&nbsp;3.3.&nbsp;Using a custom BeanWrapperContext</b></p><div class="example-contents"><pre class="programlisting">
		CustomizableBeanWrapperFactory factory = new CustomizableBeanWrapperFactory();
		factory.setBeanContextBuilder(new MyContextBuilder());
		JuffrouBeanWrapper myPersonWrapper = factory.getBeanWrapper(Person.class);
		MyBeanWrapperContext context = (MyBeanWrapperContext) myPersonWrapper.getContext();
			</pre></div></div><br class="example-break"></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e373"></a>BeanConverter</h2></div></div></div><p>The BeanConverter is a utility class to convert between two beans.</p><p>Given any two beans and a map that establishes which properties in bean 1 correspond to properties in bean 2, this class can be used to automatically obtain bean 1 from an instance of bean 2 and vice-versa.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e380"></a>ReflectionUtil</h2></div></div></div><p>The ReflectionUtil is a utility class with several helper static methods. They are all well documented in Javadoc for an easy and direct reference.</p><p>Some of these methods are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" style="list-style-type: disc"><code class="literal">getMapFromBean</code> Transform a Java bean into a Map where the keys are the property names. If there are nested beans, then the key will be the path of property names in the form "prop1.prop2.prop2". Properties with null values are not put in the map.</li><li class="listitem" style="list-style-type: disc"><code class="literal">getBeanFromMap</code> Fill up a java bean with the contents of a map where the keys are property names.</li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="d0e398"></a>Chapter&nbsp;4.&nbsp;Getting Started with Juffrou-XML</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e401"></a>Introduction</h2></div></div></div><p>Juffrou-XML is an open source java library to marshall beans to xml and back. The objective is to make this simple, logical and flexible.</p><p>With Juffrou-XML you have simplified marshalling, wich means that you can obtain the XML representation of complex structure of java beans with all its nested beans represented as nested elements, but
			you can also get a "flattened" XML representation with properties from the root bean and properties from the nested beans in a very simple manner.</p><p>Enough talk! Let's see how it works:</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e410"></a>Installing</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e413"></a>Maven projects</h3></div></div></div><p>To start using Juffrou-XML in your maven project just add the following dependency:
</p><pre class="programlisting">
<strong class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>net.sf.juffrou<strong class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>juffrou-xml<strong class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;version&gt;</strong>2.1.8-SNAPSHOT<strong class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong>
</pre><p>
This will allow you access the source code of the library as well as the javadoc files, if you have checked the options "download artifact sources" and "download atifact javadoc in your IDE."
				</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e421"></a>Non maven projects</h3></div></div></div><p>Download the file <code class="filename">juffrou-2.1.8-SNAPSHOT-bundle.zip</code> from the <a class="ulink" href="http://juffrou.sourceforge.net" target="_top"><em class="citetitle">website</em></a> and extract it's contents to a temporary directory.</p><p>Add <code class="filename">juffrou-reflect-2.1.8-SNAPSHOT.jar</code> and <code class="filename">juffrou-xml-2.1.8-SNAPSHOT.jar</code> to the classpath of your project and you are good to go.</p></div><p>With these libraries in your classpath you can start using juffrou-XML right away:</p><div class="example"><a name="d0e443"></a><p class="title"><b>Example&nbsp;4.1.&nbsp;Marshalling a java bean:</b></p><div class="example-contents"><pre class="programlisting">
	Person person = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> Person();
	person.setFirstName(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Carlos"</span>);
	person.setLastName(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Martins"</span>);
	person.setBirthDay(<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> SimpleDateFormat(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"yyyy-MM-dd"</span>).parse(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"1967-10-01"</span>));

	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	String xmlString = juffrouXml.toXml(person);
	</pre><p>The output will be the following XML:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;net.sf.juffrou.xml.test.dom.Person&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;firstName&gt;</strong>Carlos<strong class="hl-tag" style="color: #000096">&lt;/firstName&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;lastName&gt;</strong>Martins<strong class="hl-tag" style="color: #000096">&lt;/lastName&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;birthDay&gt;</strong>10/1/67 12:00 AM<strong class="hl-tag" style="color: #000096">&lt;/birthDay&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/net.sf.juffrou.xml.test.dom.Person&gt;</strong>
</pre></div></div><br class="example-break"><p>Without configuration, the names of root elements will be the class name of the corresponding bean, all its 
properties will be marshalled and the names of the child elements will be the names of the corresponding property.
Juffrou-XML is also able to unmarshall the XML text back to a person bean as long as the classes in the 
root elements are in the program classpath like in the following example:</p><div class="example"><a name="d0e454"></a><p class="title"><b>Example&nbsp;4.2.&nbsp;Unmarshalling from XML to Person:</b></p><div class="example-contents"><pre class="programlisting">
	Person person = (Person) juffrouXml.fromXml(xmlString);
</pre></div></div><br class="example-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e459"></a>Configuring Juffrou-XML</h2></div></div></div><p>If you want to change the element names of the beans or how those beans are marshalled / unmarshalled, then you need configuration. Configuration can be done either through direct coding or by means of an XML file.</p><p>To configure by file you can instantiate Juffrou-XML and pass the file name in the constructor, or you can instantiate Juffrou-XML with the default constructor and then call the readConfigFile method.</p><div class="example"><a name="d0e466"></a><p class="title"><b>Example&nbsp;4.3.&nbsp;Configuring Juffrou-XML:</b></p><div class="example-contents"><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"classpath:juffrou-config.xml"</span>);
	
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.readConfigFile(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"classpath:config-file-one.xml"</span>);
	juffrouXml.readConfigFile(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"file:/etc/config-file-two.xml"</span>);
</pre></div></div><br class="example-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e471"></a>Defining root element names</h3></div></div></div><div class="example"><a name="d0e474"></a><p class="title"><b>Example&nbsp;4.4.&nbsp;define root element names through code</b></p><div class="example-contents"><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.registerRootElement(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Person"</span>);
</pre></div></div><br class="example-break"><div class="example"><a name="d0e479"></a><p class="title"><b>Example&nbsp;4.5.&nbsp;Defining root element in configuration file</b></p><div class="example-contents"><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;mapping</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
	<span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml"</span>
	<span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml 
	http://juffrou.sourceforge.net/juffrou-xml/schemas/juffrou-xml.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

	<strong class="hl-tag" style="color: #000096">&lt;root-element</strong> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Person"</span> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.Person"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
	
<strong class="hl-tag" style="color: #000096">&lt;/mapping&gt;</strong>
</pre></div></div><br class="example-break"><p>The corresponding XML now looks like this:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;Person&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;firstName&gt;</strong>Carlos<strong class="hl-tag" style="color: #000096">&lt;/firstName&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;lastName&gt;</strong>Martins<strong class="hl-tag" style="color: #000096">&lt;/lastName&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;birthDay&gt;</strong>10/1/67 12:00 AM<strong class="hl-tag" style="color: #000096">&lt;/birthDay&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/Person&gt;</strong>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e488"></a>Defining element names</h3></div></div></div><div class="example"><a name="d0e491"></a><p class="title"><b>Example&nbsp;4.6.&nbsp;define element names through code</b></p><div class="example-contents"><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.registerElement(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"lastName"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Surname"</span>);
</pre></div></div><br class="example-break"><div class="example"><a name="d0e496"></a><p class="title"><b>Example&nbsp;4.7.&nbsp;Defining element names in configuration file</b></p><div class="example-contents"><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;mapping</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
	<span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml"</span>
	<span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml 
	http://juffrou.sourceforge.net/juffrou-xml/schemas/juffrou-xml.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

	<strong class="hl-tag" style="color: #000096">&lt;root-element</strong> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Person"</span> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.Person"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"firstName"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"lastName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Surname"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"birthDay"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;/root-element&gt;</strong>
	
<strong class="hl-tag" style="color: #000096">&lt;/mapping&gt;</strong>
</pre></div></div><br class="example-break"><p>The corresponding XML now looks like this:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;Person&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;firstName&gt;</strong>Carlos<strong class="hl-tag" style="color: #000096">&lt;/firstName&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;Surname&gt;</strong>Martins<strong class="hl-tag" style="color: #000096">&lt;/Surname&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;birthDay&gt;</strong>10/1/67 12:00 AM<strong class="hl-tag" style="color: #000096">&lt;/birthDay&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/Person&gt;</strong>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e505"></a>Defining attributes</h3></div></div></div><div class="example"><a name="d0e508"></a><p class="title"><b>Example&nbsp;4.8.&nbsp;define attributes through code</b></p><div class="example-contents"><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.registerAttribute(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"firstName"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"name"</span>);
</pre></div></div><br class="example-break"><div class="example"><a name="d0e513"></a><p class="title"><b>Example&nbsp;4.9.&nbsp;Defining attributes in configuration file</b></p><div class="example-contents"><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;mapping</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
	<span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml"</span>
	<span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml 
	http://juffrou.sourceforge.net/juffrou-xml/schemas/juffrou-xml.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

	<strong class="hl-tag" style="color: #000096">&lt;root-element</strong> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Person"</span> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.Person"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;attribute</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"firstName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"name"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"lastName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Surname"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"birthDay"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;/root-element&gt;</strong>
	
<strong class="hl-tag" style="color: #000096">&lt;/mapping&gt;</strong>
</pre></div></div><br class="example-break"><p>The corresponding XML now looks like this:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;Person</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"Carlos"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;Surname&gt;</strong>Martins<strong class="hl-tag" style="color: #000096">&lt;/Surname&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;birthDay&gt;</strong>10/1/67 12:00 AM<strong class="hl-tag" style="color: #000096">&lt;/birthDay&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/Person&gt;</strong>
</pre></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="xml_ref_chpt_02"></a>Chapter&nbsp;5.&nbsp;More Advanced Stuff</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e525"></a>Serializers</h2></div></div></div><p>Serializers are the classes responsible for translating bean property values to XML and back. Juffrou-xml comes with serializers for the basic java types, like <code class="literal">String</code>, <code class="literal">Integer</code> and <code class="literal">Boolean</code> for instance. <em><span class="remark">You can see the complete list of serializers in the javadoc for the package net.sf.juffrou.xml.serializer</span></em>.</p><p>You may want to create your own serializers and tell juffrou to use them. For intance, you may want to have properties of type <code class="literal">Date</code> displayed in a particular format, so you create a serailizer that knows how to convert between <code class="literal">Date</code> and that specific format.
			You can also use serializers to convert between the text in an XML element and a more complex type. For example, in a class called <code class="literal">Person</code>, with a property <code class="literal">private Address home</code> you may want to represent <code class="literal">home</code> as a single text string. In this case you create a serializer that knows how to convert between <code class="literal">Address</code> and that text string.
			</p><p>Creating your own serializer is simple. Just implement the <span class="command"><strong>Serializer</strong></span> interface like in the following example:</p><pre class="programlisting">
<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong> SimpleDateSerializer <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">implements</strong> Serializer {

	<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">private</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">final</strong> SimpleDateFormat formatter = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> SimpleDateFormat(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"yyyy-MM-dd"</span>);
	
	<em><span class="hl-annotation" style="color: gray">@Override</span></em>
	<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">void</strong> serialize(JuffrouWriter writer, BeanWrapper valueOwner, 
			String valuePropertyName) {
		writer.write(formatter.format((Date)valueOwner.getValue(valuePropertyName)));
	}

	<em><span class="hl-annotation" style="color: gray">@Override</span></em>
	<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">public</strong> <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">void</strong> deserialize(JuffrouReader reader, BeanWrapper valueOwner, 
			String valuePropertyName) {
		String value = reader.getText();
		<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">try</strong> {
			valueOwner.setValue(valuePropertyName, formatter.parse(value));
		} <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">catch</strong> (ParseException e) {
		}
	}
}
</pre><p>Once your serializer class is created, you can use it to translate your beans or bean properties using by configuring through code or mapping file.</p><div class="example"><a name="d0e571"></a><p class="title"><b>Example&nbsp;5.1.&nbsp;using serializers through code</b></p><div class="example-contents"><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.registerSerializer(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"mySimpleDateSerializer"</span>, <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> SimpleDateSerializer());
	juffrouXml.registerElement(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"birthDay"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"birthday"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"mySimpleDateSerializer"</span>);
</pre></div></div><br class="example-break"><div class="example"><a name="d0e576"></a><p class="title"><b>Example&nbsp;5.2.&nbsp;using serializers through configuration file</b></p><div class="example-contents"><p>When using a configuration file you can define reusable serializers to share between bean properties or define a serializer that is exlusive to a perticular bean property.</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;mapping</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
	<span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml"</span>
	<span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml 
	http://juffrou.sourceforge.net/juffrou-xml/schemas/juffrou-xml.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

	<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"mySimpleDateSerializer"</span> 
		<span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.SimpleDateSerializer"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
	
	<strong class="hl-tag" style="color: #000096">&lt;root-element</strong> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Person"</span> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.Person"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;attribute</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"firstName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"name"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"lastName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Surname"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
			<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.serializer.StringSerializer"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;/element&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"birthDay"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"birthday"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
			<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> <span class="hl-attribute" style="color: #F5844C">ref</span>=<span class="hl-value" style="color: #993300">"mySimpleDateSerializer"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;/element&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;/root-element&gt;</strong>
	
<strong class="hl-tag" style="color: #000096">&lt;/mapping&gt;</strong>
</pre></div></div><br class="example-break"><p>You can define serializers to share between bean properties with <code class="literal">serializer</code> element in the mapping file:</p><pre class="programlisting">
	<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"mySimpleDateSerializer"</span> <a class="co" name="srl_id" href="#l_srl_id"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> 
		class="net.sf.juffrou.xml.test.dom.SimpleDateSerializer"/&gt;  <a class="co" name="srl_classimpl" href="#l_srl_classimpl"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a>
</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="l_srl_id"></a><a href="#srl_id"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> </p></td><td valign="top" align="left"><p>Id of the serializer to be referenced by the bean property serializers.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="l_srl_classimpl"></a><a href="#srl_classimpl"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> </p></td><td valign="top" align="left"><p>Class name of the serializer. This class will be instantiated only once and will be shared between the bean properties that reference it.</p></td></tr></table></div><p>You can define a serializer for a bean property by nesting a <code class="literal">serializer</code> element like in the above example. Below are all the properties for a property serializer:</p><pre class="programlisting">
	<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> 
		<span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.SimpleDateSerializer"</span>  <a class="co" name="srl_class" href="#l_srl_class"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> 
		ref="mySimpleDateSerializer"  <a class="co" name="srl_ref" href="#l_srl_ref"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> 
		bean="mySpringBeanSerializer" /&gt;  <a class="co" name="srl_bean" href="#l_srl_bean"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a>
</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="l_srl_class"></a><a href="#srl_class"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> </p></td><td valign="top" align="left"><p>Class name of the specific serializer class to use. This class will be instantiated and used exclusively for the bean property.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="l_srl_ref"></a><a href="#srl_ref"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> </p></td><td valign="top" align="left"><p>Id of the shared serializer.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="l_srl_bean"></a><a href="#srl_bean"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a> </p></td><td valign="top" align="left"><p>Id of a springframework bean which implements <code class="literal">serializer</code>. This is only valid when using the library <code class="literal">juffrou-xml-spring</code></p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e629"></a>Simplified Marshalling</h2></div></div></div><p>Simplified marshalling is the possibility of marshalling nested beans into a "flat" XML structure like this: imagine that you don't want the whole home address marshalled for this person. You only want his home city 
and you want it displayed as it were a simple property of person.</p><p>Easy! All you have to do is this:</p><pre class="programlisting">
	JuffrouXml juffrouXml = <strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">new</strong> JuffrouXml();
	juffrouXml.registerRootElement(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"Person"</span>);
	juffrouXml.registerElement(Person.<strong xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:#950055">class</strong>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"home.city"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-string" style="color:blue">"homeTown"</span>, null);
	String xmlString = juffrouXml.toXml(person);
</pre><p>The output will now be:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;Person&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;firstName&gt;</strong>Carlos<strong class="hl-tag" style="color: #000096">&lt;/firstName&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;lastName&gt;</strong>Martins<strong class="hl-tag" style="color: #000096">&lt;/lastName&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;birthDay&gt;</strong>1967-10-01<strong class="hl-tag" style="color: #000096">&lt;/birthDay&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;homeTown&gt;</strong>Lisboa<strong class="hl-tag" style="color: #000096">&lt;/homeTown&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/Person&gt;</strong>
</pre><p>Of course this XML will also be unmarshalled back to a person object. That person object will have a home with city Lisboa.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="spring_ref_chpt_01"></a>Chapter&nbsp;6.&nbsp;Getting Started with Juffrou-XML-Spring</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e648"></a>Introduction</h2></div></div></div><p>Juffrou-XML-Spring is the implementation of springframework's (spring-oxm) Marshaller and Unmarshaller interfaces using Juffrou-XML.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e653"></a>Installing</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e656"></a>Maven projects</h3></div></div></div><p>To start using Juffrou-XML in your maven project just add the following dependency:
</p><pre class="programlisting">
<strong class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>net.sf.juffrou<strong class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>juffrou-xml-spring<strong class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;version&gt;</strong>2.1.8-SNAPSHOT<strong class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong>
</pre><p>
This will allow you access the source code of the library as well as the javadoc files, if you have checked the options "download artifact sources" and "download atifact javadoc in your IDE."
				</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e664"></a>Non maven projects</h3></div></div></div><p>Download the file <code class="filename">juffrou-2.1.8-SNAPSHOT-bundle.zip</code> from the <a class="ulink" href="http://juffrou.sourceforge.net" target="_top"><em class="citetitle">website</em></a> and extract it's contents to a temporary directory.</p><p>Add <code class="filename">juffrou-reflect-2.1.8-SNAPSHOT.jar</code>, <code class="filename">juffrou-xml-2.1.8-SNAPSHOT.jar</code> and <code class="filename">juffrou-xml-spring-2.1.8-SNAPSHOT.jar</code> to the classpath of your project and you are good to go.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e687"></a>Configuring Juffrou-XML though Spring</h2></div></div></div><p>In a spring application context, Juffrou-XML is a bean and can be configured like any other bean in spring.</p><div class="example"><a name="d0e692"></a><p class="title"><b>Example&nbsp;6.1.&nbsp;Juffrou-XML Spring Configuration</b></p><div class="example-contents"><pre class="programlisting">
    <strong class="hl-tag" style="color: #000096">&lt;bean</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"marshaller"</span> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.JuffrouXmlSpring"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    	<strong class="hl-tag" style="color: #000096">&lt;property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"mappingLocations"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    		<strong class="hl-tag" style="color: #000096">&lt;list&gt;</strong>
    			<strong class="hl-tag" style="color: #000096">&lt;value&gt;</strong>classpath:/net/sf/juffrou/**/*-xml-mapping.xml<strong class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
    			<strong class="hl-tag" style="color: #000096">&lt;value&gt;</strong>file:${CONFIG_LOCATION}/juffrou-xml/**/*-xml-mapping.xml<strong class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
    		<strong class="hl-tag" style="color: #000096">&lt;/list&gt;</strong>
    	<strong class="hl-tag" style="color: #000096">&lt;/property&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
</pre></div></div><br class="example-break"><p>In the above example spring tells juffrou-xml to load its configuration from several mapping files.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e699"></a>Defining serializers as spring beans</h3></div></div></div><p>Serializers may be used to convert between the text in an XML element and a complex type. With juffrou-xml-spring you can define your serializers as java beans and thus take advantage of spring's dependency injection mechanism.</p><p>For example purposes lets consider the <code class="literal">SimpleDateSerializer</code> from the spring-xml reference. First we would define the serializer bean:</p><pre class="programlisting">
	<strong class="hl-tag" style="color: #000096">&lt;bean</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"mySimpleDateSerializerBean"</span> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.SimpleDateSerializer"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

    <strong class="hl-tag" style="color: #000096">&lt;bean</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"marshaller"</span> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.JuffrouMarshaller"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    	<strong class="hl-tag" style="color: #000096">&lt;property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"mappingLocations"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    		<strong class="hl-tag" style="color: #000096">&lt;list&gt;</strong>
    			<strong class="hl-tag" style="color: #000096">&lt;value&gt;</strong>classpath:/net/sf/juffrou/**/*-xml-mapping.xml<strong class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
    			<strong class="hl-tag" style="color: #000096">&lt;value&gt;</strong>file:${CONFIG_LOCATION}/juffrou-xml/**/*-xml-mapping.xml<strong class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
    		<strong class="hl-tag" style="color: #000096">&lt;/list&gt;</strong>
    	<strong class="hl-tag" style="color: #000096">&lt;/property&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
</pre><p>To use this serializer bean in juffrou-xml you would configure the configuration mapping like the following example:</p><pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;mapping</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
	<span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml"</span>
	<span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://juffrou.sourceforge.net/juffrou-xml 
	http://juffrou.sourceforge.net/juffrou-xml/schemas/juffrou-xml.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

	<strong class="hl-tag" style="color: #000096">&lt;root-element</strong> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Person"</span> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"net.sf.juffrou.xml.test.dom.Person"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;attribute</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"firstName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"name"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"lastName"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"Surname"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;element</strong> <span class="hl-attribute" style="color: #F5844C">property</span>=<span class="hl-value" style="color: #993300">"birthDay"</span> <span class="hl-attribute" style="color: #F5844C">xml</span>=<span class="hl-value" style="color: #993300">"birthday"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
			<strong class="hl-tag" style="color: #000096">&lt;serializer</strong> <span class="hl-attribute" style="color: #F5844C">bean</span>=<span class="hl-value" style="color: #993300">"mySimpleDateSerializerBean"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
		<strong class="hl-tag" style="color: #000096">&lt;/element&gt;</strong>
	<strong class="hl-tag" style="color: #000096">&lt;/root-element&gt;</strong>
	
<strong class="hl-tag" style="color: #000096">&lt;/mapping&gt;</strong>
</pre></div></div></div></div></body></html>