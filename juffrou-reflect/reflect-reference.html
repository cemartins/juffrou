<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-03-07 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140307" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Juffrou Reflect - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="author" href="http://plus.google.com/111660341923910322609"/>
                      
        
<link rel="shortcut icon" href="http://juffrou.sourceforge.net/favicon.ico"/>
                      
        
<script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
			
			  ga('create', 'UA-36088259-2', 'sourceforge.net');
			  ga('send', 'pageview');</script>
          
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://github.com/cemartins/juffrou/" id="bannerLeft">
                                                                                                <img src="../images/juffrou_extense.jpg"  alt="Juffrou" width="334" height="73"/>
                </a>
                      </div>
        <div class="pull-right">              <div id="bannerRight">
                                                                                                <img src="../images/juffrou_text_new.jpg"  width="140" height="73"/>
                </div>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../index.html" title="Juffrou">
        Juffrou</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="http://juffrou.sourceforge.net/index.html" class="externalLink" title="Juffrou">
        Juffrou</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="http://juffrou.sourceforge.net/juffrou-reflect/index.html" class="externalLink" title="Reflect">
        Reflect</a>
                    <span class="divider">/</span>
      </li>
        <li class="active "></li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2014-03-07</li>
              <li id="projectVersion" class="pull-right">
                    Version: 2.1.5-SNAPSHOT
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Juffrou">
          <i class="none"></i>
        Juffrou</a>
            </li>
                              <li class="nav-header">Juffrou Reflect</li>
                              
      <li>
  
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Reference</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                              
      <li>
  
                          <a href="apidocs/index.html" title="Javadocs">
          <i class="none"></i>
        Javadocs</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://cemartins.github.io/juffrou/juffrou-reflect" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
               
        
        
        <div id="twitter">
    
    <a href="https://twitter.com/ceamartins" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ceamartins</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </div>
                   <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="https://github.com/cemartins/juffrou" title="Powered by Github (click for project page)" class="builtBy">
        <img class="builtBy"  alt="Powered by Github (click for project page)" src="../images/GitHub_Logo_Small.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            
	<b>Juffrou-Reflect Reference Documentation</b>
	
	
	This document refers to version  of the .

<p>Copies of this document may be made for your own use and for distribution to others, provided
that you do not charge any fee for such copies and further provided that each copy contains this
Copyright Notice, whether distributed in print or electronically.</p>
		
			
				Carlos
				Martins
			
		
	
	
		<b>Getting Started with Juffrou-reflect</b>
		
<div class="section">
			
<h2>Introduction<a name="Introduction"></a></h2>
			
<p>Juffrou-reflect is focused on reflection, and offers a very performant bean wrapper allowing bean introspection and manipulation through property names.</p>
		</div>
		
<div class="section">
			
<h2>Installing<a name="Installing"></a></h2>
			
<div class="section">
				
<h3>Maven projects<a name="Maven_projects"></a></h3>
				
<p>To start using Juffrou-XML in your maven project just add the following dependency:
</p>
<div class="source">
<pre>
	&lt;dependency&gt;
		&lt;groupId&gt;net.sf.juffrou&lt;/groupId&gt;
		&lt;artifactId&gt;juffrou-reflect&lt;/artifactId&gt;
		&lt;version&gt;&lt;/version&gt;
	&lt;/dependency&gt;

</pre></div>
This will allow you access the source code of the library as well as the javadoc files, if you have checked the options &quot;download artifact sources&quot; and &quot;download atifact javadoc in your IDE.&quot;
				
			</div>
			
<div class="section">
				
<h3>Non maven projects<a name="Non_maven_projects"></a></h3>
					
<p>Download the file <tt>juffrou--bundle.zip</tt> from the <a class="externalLink" href="http://juffrou.sourceforge.net"><i>website</i></a> and extract it's contents to a temporary directory.</p>
					
<p>Add <tt>juffrou-reflect-.jar</tt> to the classpath of your project and you are good to go.</p>
			</div>
		</div>
	
	
		<b>Using Juffrou-reflect</b>
		
<div class="section">
			
<h2>JuffrouBeanWrapper<a name="JuffrouBeanWrapper"></a></h2>
			
<p>JuffrouBeanWrapper is the object that wraps around your beans and allows you to inspect them through the names of their properties. You can access the wrapped bean's properties and also the properties of beans referenced by them.</p>
			<b>Example class diagram</b>
			
<div class="figure">
				
					
<p align="center"><img src="images/ClassDiagram.PNG" alt="" /></p>
				
			</div>
			
			
<p><a href="#ClassDiagram">Link</a> shows one class Person with three simple attributes and one attribute of type Address. The Address class is also shown and has two simple attributes.</p>
			Person and Address will be used extensively throughout this manual in code examples.
			A tipical use of JuffrouBeanWrapper could be:
			
<div class="source">
<pre>
			JuffrouBeanWrapper bw = new JuffrouBeanWrapper(Person.class); 
			bw.setValue(&quot;firstName&quot;, &quot;Carlos&quot;); 
			bw.setValue(&quot;home.city&quot;, &quot;Lisboa&quot;); 
			Person person = (Person) bw.getBean(); 
			</pre></div>
Note: you can create a JuffrouBeanWrapper around a class or around an object instance.

  
    
<p>Instantiate JuffrouBeanWrapper around a Person class</p>
  
  
    
<p>Set the firstName property of Person with the value &quot;Carlos&quot;.</p>
  
  
    
<p>Set the home property of Person with a new instance of an Address class and set the city property of Address to the value &quot;Lisboa&quot;.</p>
  
  
    
<p>Get the instance of the wrapped object.</p>
  

  
<p>When the program executes <tt>bw.setValue(&quot;firstName&quot;, &quot;Carlos&quot;);</tt> the bean wrapper creates an instance of Person. And when it
  executes <tt>bw.setValue(&quot;home.city&quot;, &quot;Lisboa&quot;);</tt> it will instantiate an Address class, set the value of the property <b><tt>city</tt></b> in Address to &quot;Lisboa&quot; and set the value of the property <b><tt>home</tt></b> in Person to the created Address instance.</p>
  
  
<div class="section">
<h3>Setting Bean Property Values<a name="Setting_Bean_Property_Values"></a></h3>
  
<p>When you execute the method <tt>bw.setValue(&quot;birthDay&quot;, someObject)</tt> to set the value of the birthDay property, the JuffrouBeanWrapper expects <tt>someObject</tt> to be of the same type as the bean property (in this case Date). And if it is not, it will throw an IllegalArgumentException exception.</p>
  
<p>But if you use the method <tt>setValueOfString(&quot;birthDay&quot;, &quot;1967-10-01&quot;)</tt>, then the JuffrouBeanWrapper will try to convert the string value into the type of the property before setting it.</p>
  </div>
  
  
<div class="section">
<h3>Nested BeanWrappers<a name="Nested_BeanWrappers"></a></h3>
  	
<p>When you access a nested property (i.e. a property of a nested bean), like in the case of <tt>bw.setValue(&quot;home.city&quot;, &quot;Lisboa&quot;)</tt>, the JuffrouBeanWrapper automatically creates another JuffrouBeanWrapper around the nested bean. In this case around an Address bean. This is called a nested bean wrapper.</p>
  	
<p>Nested JuffrouBeanWrappers are created only when referenced by <tt>beanWrapper.getValue</tt>, <tt>beanWrapper.setValue</tt>, <tt>beanWrapper.getType</tt>, <tt>beanWrapper.getClass</tt> or <tt>beanWrapper.getNestedWrapper</tt>.</p>
  	
<p>You can get a specific nested bean wrapper with the method <tt>beanWrapper.getNestedWrapper(&quot;home&quot;)</tt> and you can get all current nested bean wrappers with the method <tt>beanWrapper.getNestedWrappers()</tt>.</p>
  	
<p>If you want to change the wrapped instance without creating a new JuffrouBeanWrapper you can call <tt>bw.setBean(newInstance)</tt> and if you want to zero all properties of the wrapped instance you can call <tt>bw.setBean(null)</tt>.</p>
  </div>
   <!-- Conditional page break -->
  
<p>In case you don't know the details of the Wrapped object, you can inquire the JuffrouBeanWrapper:</p>

<h2>Inquiring the JuffrouBeanWrapper:<a name="Inquiring_the_JuffrouBeanWrapper:"></a></h2>
	
<div class="source">
<pre>
		BeanWrapperContext context = BeanWrapperContext.create(Programmer.class);
		JuffrouBeanWrapper beanWrapper = new JuffrouBeanWrapper(context);
		for(String propertyName : beanWrapper.getPropertyNames()) {
			Type type = beanWrapper.getType(propertyName);
			Object value = beanWrapper.getValue(propertyName);
			System.out.println(type + &quot;: &quot; + value);
		}
	</pre></div>

  
  
<p>Sometimes you want to have control over bean instantiation and would like to set some &quot;preferences&quot; over how JuffrouBeanWrapper behaves. This is where the BeanWrapperContext comes in.</p>
		<!-- <?hard-pagebreak?> --> <!-- Conditional page break -->
		
<div class="section">
			
<h3>BeanWrapperContext<a name="BeanWrapperContext"></a></h3>
			
<p>The BeanWrapperContext is the object that holds metadata for a BeanWrapper. This metadata is composed by data collected through class introspection, including the references to the getter and setter methods of the class and all classes it extends.</p>
			
<p>If you instantiate a BeanWrapper using the default constructor, it will create a new BeanWrapperContext. But if you instantiate a BeanWrapper by passing a BeanWrapperContext, no introspection overhead is needed.</p>
			
				
<table border="1" class="table table-striped"><caption>time in milliseconds to handle 10.000 BeanWrappers</caption>
				
				
<tr class="a">
				  
<th>Mode</th>
				  
<th>Instantiation only</th>
				  
<th>With property setting</th>
				</tr>
				
				
					
<tr class="b">
						
<td>Spring Framework's BeanWrapperImpl</td>
<td>64</td>
<td>291</td>
					</tr>
					
<tr class="a">
						
<td>JuffrouBeanWrapper</td>
<td>9</td>
<td>41</td>
					</tr>
					
<tr class="b">
						
<td>JuffrouBeanWrapper with BeanWrapperContext</td>
<td>1</td>
<td>20</td>
					</tr>
					
<tr class="a">
						
<td>JuffrouBeanWrapper with BeanWrapperFactory</td>
<td>9</td>
<td>20</td>
					</tr>
				
				
			</table>
			JDK 6 build 35 running on a Windows 7 32bit (Intel i3 2,93GHz with 4GB ram) machine
			
<p>When a JuffrouBeanWrapper creates a nested JuffrouBeanWrapper it also creates a nested BeanWrapperContext, of course. But it will only create one BeanWrapperContext per property type, so, for instance, if you have a BeanWrapper around a class Person with two properties (home and work) of type Address, you can have two nested JuffrouBeanWrappers (one for home and another for work), but only one nested BeanWrapperContext.</p>
			
<p>You can obtain the BeanWrapperContext of a JuffrouBeanWrapper at any time calling the method <tt>beanWrapper.getContext()</tt>.</p>
			
<div class="section">
<h4>Controling bean instantiation<a name="Controling_bean_instantiation"></a></h4>
			
<p>With BeanWrapperContext you can define a class that will be called to instantiate the wrapped class as well as the classes of the nested beans whenever they need to be instantiated. To do this, first create a class that implements the interface <tt>BeanInstanceBuilder</tt>. See the following example:</p>
			
<div class="source">
<pre>
		BeanInstanceBuilder iCreator = new BeanInstanceBuilder() {
			@Override
			public Object build(Class clazz) throws BeanInstanceBuilderException {
				Programmer programmer = new Programmer();
				programmer.setLastName(&quot;Smith&quot;);
				return programmer;
			}
		};
		BeanWrapperContext context = BeanWrapperContext.create(Programmer.class);
		context.setBeanInstanceBuilder(iCreator);
		JuffrouBeanWrapper bw = new JuffrouBeanWrapper(context);
		bw.setValue(&quot;firstName&quot;, &quot;John&quot;);
		Programmer programmer = (Programmer) bw.getBean();
		Assert.assertEquals(&quot;John&quot;, programmer.getFirstName());
		Assert.assertEquals(&quot;Smith&quot;, programmer.getLastName());
			</pre></div>
			
<p>You might also want to associate more information with a bean than the introspection information collected by the BeanWrapperContext.
			For instance you might want add information to help represent the bean in XML format (like Juffrou-XML does). This is where the CustomizableBeanWrapperFactory comes in.</p>
			</div>

			
<div class="section">
<h4>CustomizableBeanWrapperFactory<a name="CustomizableBeanWrapperFactory"></a></h4>
			
<p>The BeanWrapperFactory is the object responsible for creating all the BeanWrapperContexts. It does mainly three things:</p>
	
<ul>

<li>Keeps track of the BeanWrapperContexts it creates, so it doesn't create two BeanWrapperContexts for the same bean class.</li>

<li>Injects itself into the BeanWrapperContexts it creates, so that they can use the same factory to create their nested BeanWrapperContexts.</li>

<li>Gives out BeanWrapperContexts upon call to <tt>factory.getBeanWrapperContext(Person.class)</tt> method. The BeanWrapperContext will only be created in none exists for the specified class (in this case Person.class).</li>
</ul>
			
<p>In fact you can also use the BeanWrapperFactory to instantiate JuffrouBeanWrappers using the methods <tt>factory.getBeanWrapper(Person.class)</tt> or <tt>factory.getBeanWrapper(personIntance)</tt> for example. This is as fast as instantiating a JuffrouBeanWrapper with a BeanWrapperContext parameter.</p>
			</div>
			
<div class="section">
<h4>Extending the BeanWrapperContext<a name="Extending_the_BeanWrapperContext"></a></h4>			
			
<p>So if you want to extend the BeanWrapperContext and add to the bean metadata all you have to do is create a class that extends BeanWrapperContext and &quot;tell&quot; the CustomizableBeanWrapperFactory to instantiate your class instead of BeanWrapperContext.</p>
			
<h4>Class that extends BeanWrapperContext<a name="Class_that_extends_BeanWrapperContext"></a></h4>
			
<div class="source">
<pre>
public class MyBeanWrapperContext extends BeanWrapperContext {

	//TODO create properties to extend the context
	
	public MyBeanWrapperContext(CustomizableBeanWrapperFactory factory, Class clazz, Type... types) {
		super(factory, clazz, types);
		//TODO some initialization
	}
}
			</pre></div>
			
			
<p>And how do we &quot;tell&quot; the CustomizableBeanWrapperFactory to use this as BeanWrapperContext? Easy. We create a class that implements <i>BeanContextBuilder</i> like this one:</p>
			
<div class="source">
<pre>
public class MyContextBuilder implements BeanContextBuilder {

	@Override
	public MyBeanWrapperContext build(
						CustomizableBeanWrapperFactory factory,	Class clazz, Type... types) {

		MyBeanWrapperContext context = new MyBeanWrapperContext(factory, clazz, types);
		return context;
	}
}
			</pre></div>
			
<p>And then we &quot;tell&quot; CustomizableBeanWrapperFactory to use this builder. See the example bellow:</p>
			
<h4>Using a custom BeanWrapperContext<a name="Using_a_custom_BeanWrapperContext"></a></h4>
			
<div class="source">
<pre>
		CustomizableBeanWrapperFactory factory = new CustomizableBeanWrapperFactory();
		factory.setBeanContextBuilder(new MyContextBuilder());
		JuffrouBeanWrapper myPersonWrapper = factory.getBeanWrapper(Person.class);
		MyBeanWrapperContext context = (MyBeanWrapperContext) myPersonWrapper.getContext();
			</pre></div>
			
			</div>
		</div>
	</div>

		
<div class="section">
			
<h2>BeanConverter<a name="BeanConverter"></a></h2>
			
<p>The BeanConverter is a utility class to convert between two beans.</p>
			
<p>Given any two beans and a map that establishes which properties in bean 1 correspond to properties in bean 2, this class can be used to automatically obtain bean 1 from an instance of bean 2 and vice-versa.</p>
		</div>
		
<div class="section">
			
<h2>ReflectionUtil<a name="ReflectionUtil"></a></h2>
			
<p>The ReflectionUtil is a utility class with several helper static methods. They are all well documented in Javadoc for an easy and direct reference.</p>
			
<p>Some of these methods are:</p>
	
<ul>

<li><tt>getMapFromBean</tt> Transform a Java bean into a Map where the keys are the property names. If there are nested beans, then the key will be the path of property names in the form &quot;prop1.prop2.prop2&quot;. Properties with null values are not put in the map.</li>

<li><tt>getBeanFromMap</tt> Fill up a java bean with the contents of a map where the keys are property names.</li>
</ul>
		</div>
	

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2011&#x2013;2014
                        <a href="http://martins.dtdns.net/~cemartins">Carlos Martins</a>.
            All rights reserved.      
                    
      </p>
        </div>

                          
        
                </div>
    </footer>
        </body>
</html>
